(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{672:function(t,v,_){"use strict";_.r(v);var r=_(16),a=Object(r.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"使用-rail-模型评估性能"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用-rail-模型评估性能"}},[t._v("#")]),t._v(" 使用 RAIL 模型评估性能")]),t._v(" "),_("p",[t._v("https://web.dev/rail/")]),t._v(" "),_("p",[t._v("RAIL 是一种以用户为中心的性能模型。每个网络应用均具有与其生命周期有关的四个不同方面，且这些方面以不同的方式影响着性能：")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/coalyer/image-store@master/blog/performance/rail.png",alt:"img"}})]),t._v(" "),_("p",[t._v("TLDR")]),t._v(" "),_("ul",[_("li",[t._v("以用户为中心；最终目标不是让您的网站在任何特定设备上都能运行很快，而是使用户满意。")]),t._v(" "),_("li",[t._v("立即响应用户；在 100 毫秒以内确认用户输入。")]),t._v(" "),_("li",[t._v("设置动画或滚动时，在 10 毫秒以内生成帧。")]),t._v(" "),_("li",[t._v("最大程度增加主线程的空闲时间。")]),t._v(" "),_("li",[t._v("持续吸引用户；在 1000 毫秒以内呈现交互内容。")])]),t._v(" "),_("h2",{attrs:{id:"以用户为中心"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#以用户为中心"}},[t._v("#")]),t._v(" 以用户为中心")]),t._v(" "),_("p",[t._v("让用户成为您的性能工作的中心。用户花在网站上的大多数时间不是等待加载，而是在使用时等待响应。了解用户如何评价性能延迟：")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("延迟与用户反应")]),t._v(" "),_("th")])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("0 - 16 毫秒")]),t._v(" "),_("td",[t._v("人们特别擅长跟踪运动，如果动画不流畅，他们就会对运动心生反感。 用户可以感知每秒渲染 60 帧的平滑动画转场。也就是每帧 16 毫秒（包括浏览器将新帧绘制到屏幕上所需的时间），留给应用大约 10 毫秒的时间来生成一帧。")])]),t._v(" "),_("tr",[_("td",[t._v("0 - 100 毫秒")]),t._v(" "),_("td",[t._v("在此时间窗口内响应用户操作，他们会觉得可以立即获得结果。时间再长，操作与反应之间的连接就会中断。")])]),t._v(" "),_("tr",[_("td",[t._v("100 - 300 毫秒")]),t._v(" "),_("td",[t._v("用户会遇到轻微可觉察的延迟。")])]),t._v(" "),_("tr",[_("td",[t._v("300 - 1000 毫秒")]),t._v(" "),_("td",[t._v("在此窗口内，延迟感觉像是任务自然和持续发展的一部分。对于网络上的大多数用户，加载页面或更改视图代表着一个任务。")])]),t._v(" "),_("tr",[_("td",[t._v("1000+ 毫秒")]),t._v(" "),_("td",[t._v("超过 1 秒，用户的注意力将离开他们正在执行的任务。")])]),t._v(" "),_("tr",[_("td",[t._v("10,000+ 毫秒")]),t._v(" "),_("td",[t._v("用户感到失望，可能会放弃任务；之后他们或许不会再回来。")])])])]),t._v(" "),_("h2",{attrs:{id:"响应-在-100-毫秒以内响应"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#响应-在-100-毫秒以内响应"}},[t._v("#")]),t._v(" 响应：在 100 毫秒以内响应")]),t._v(" "),_("p",[t._v("在用户注意到滞后之前您有 100 毫秒的时间可以响应用户输入。这适用于大多数输入，不管他们是在点击按钮、切换表单控件还是启动动画。但不适用于触摸拖动或滚动。")]),t._v(" "),_("p",[t._v("如果您未响应，操作与反应之间的连接就会中断。用户会注意到。")]),t._v(" "),_("p",[t._v("尽管很明显应立即响应用户的操作，但这并不总是正确的做法。使用此 100 毫秒窗口执行其他开销大的工作，但需要谨慎，以免妨碍用户。如果可能，请在后台执行工作。")]),t._v(" "),_("p",[t._v("对于需要超过 500 毫秒才能完成的操作，请始终提供反馈。")]),t._v(" "),_("h2",{attrs:{id:"动画-在-10-毫秒内生成一帧"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#动画-在-10-毫秒内生成一帧"}},[t._v("#")]),t._v(" 动画：在 10 毫秒内生成一帧")]),t._v(" "),_("p",[t._v("动画不只是奇特的 UI 效果。例如，滚动和触摸拖动就是动画类型。")]),t._v(" "),_("p",[t._v("如果动画帧率发生变化，您的用户确实会注意到。您的目标就是每秒生成 60 帧，每一帧必须完成以下所有步骤：")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/coalyer/image-store@master/blog/performance/render-frame.png",alt:"img"}})]),t._v(" "),_("p",[t._v("从纯粹的数学角度而言，每帧的预算约为 16 毫秒（1000 毫秒 / 60 帧 = 16.66 毫秒/帧）。 但因为浏览器需要花费时间将新帧绘制到屏幕上，只有 10 毫秒来执行代码。")]),t._v(" "),_("p",[t._v("在像动画一样的高压点中，关键是不论能不能做，什么都不要做，做最少的工作。 如果可能，请利用 100 毫秒响应预先计算开销大的工作，这样您就可以尽可能增加实现 60fps 的可能性。")]),t._v(" "),_("p",[t._v("如需了解详细信息，请参阅渲染性能。")]),t._v(" "),_("h2",{attrs:{id:"空闲-最大程度增加空闲时间"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#空闲-最大程度增加空闲时间"}},[t._v("#")]),t._v(" 空闲：最大程度增加空闲时间")]),t._v(" "),_("p",[t._v("利用空闲时间完成推迟的工作。例如，尽可能减少预加载数据，以便您的应用快速加载，并利用空闲时间加载剩余数据。")]),t._v(" "),_("p",[t._v("推迟的工作应分成每个耗时约 50 毫秒的多个块。如果用户开始交互，优先级最高的事项是响应用户。")]),t._v(" "),_("p",[t._v("要实现小于 100 毫秒的响应，应用必须在每 50 毫秒内将控制返回给主线程，这样应用就可以执行其像素管道、对用户输入作出反应，等等。")]),t._v(" "),_("p",[t._v("以 50 毫秒块工作既可以完成任务，又能确保即时的响应。")]),t._v(" "),_("h2",{attrs:{id:"加载-在-1000-毫秒以内呈现内容"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#加载-在-1000-毫秒以内呈现内容"}},[t._v("#")]),t._v(" 加载：在 1000 毫秒以内呈现内容")]),t._v(" "),_("p",[t._v("在 1 秒钟内加载您的网站。否则，用户的注意力会分散，他们处理任务的感觉会中断。")]),t._v(" "),_("p",[t._v("侧重于优化关键渲染路径以取消阻止渲染。")]),t._v(" "),_("p",[t._v("您无需在 1 秒内加载所有内容以产生完整加载的感觉。启用渐进式渲染和在后台执行一些工作。将非必需的加载推迟到空闲时间段（请参阅此"),_("a",{attrs:{href:"https://cn.udacity.com/course/website-performance-optimization--ud884",target:"_blank",rel:"noopener noreferrer"}},[t._v("网站性能优化 Udacity 课程"),_("OutboundLink")],1),t._v("，了解更多信息）。")]),t._v(" "),_("h2",{attrs:{id:"关键-rail-指标汇总"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#关键-rail-指标汇总"}},[t._v("#")]),t._v(" 关键 RAIL 指标汇总")]),t._v(" "),_("p",[t._v("要根据 RAIL 指标评估您的网站，请使用 Chrome DevTools Timeline 工具记录用户操作。然后根据这些关键 RAIL 指标检查 Timeline 中的记录时间。")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("RAIL 步骤")]),t._v(" "),_("th",[t._v("关键指标")]),t._v(" "),_("th",[t._v("用户操作")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("响应")]),t._v(" "),_("td",[t._v("输入延迟时间（从点按到绘制）小于 100 毫秒。")]),t._v(" "),_("td",[t._v("用户点按按钮（例如打开导航）。")])]),t._v(" "),_("tr",[_("td",[t._v("动画")]),t._v(" "),_("td",[t._v("每个帧的工作（从 JS 到绘制）完成时间小于 16 毫秒。")]),t._v(" "),_("td",[t._v("用户滚动页面，拖动手指（例如，打开菜单）或看到动画。 拖动时，应用的响应与手指位置有关（例如，拉动刷新、滑动轮播）。 此指标仅适用于拖动的持续阶段，不适用于开始阶段。")])]),t._v(" "),_("tr",[_("td",[t._v("空闲")]),t._v(" "),_("td",[t._v("主线程 JS 工作分成不大于 50 毫秒的块。")]),t._v(" "),_("td",[t._v("用户没有与页面交互，但主线程应足够用于处理下一个用户输入。")])]),t._v(" "),_("tr",[_("td",[t._v("加载")]),t._v(" "),_("td",[t._v("页面可以在 1000 毫秒内就绪。")]),t._v(" "),_("td",[t._v("用户加载页面并看到关键路径内容。")])])])])])}),[],!1,null,null,null);v.default=a.exports}}]);