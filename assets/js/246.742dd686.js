(window.webpackJsonp=window.webpackJsonp||[]).push([[246],{657:function(e,a,t){"use strict";t.r(a);var n=t(16),s=Object(n.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"监控和分析应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#监控和分析应用"}},[e._v("#")]),e._v(" 监控和分析应用")]),e._v(" "),t("p",[e._v("即使将webpack配置为使应用程序尽可能小，跟踪并了解其包含的内容仍然很重要。否则，您可以安装一个依赖项，使该应用程序的大小增加一倍–甚至不会注意到它！")]),e._v(" "),t("p",[e._v("本节介绍可帮助您了解捆绑软件的工具。")]),e._v(" "),t("h2",{attrs:{id:"跟踪捆绑包的大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#跟踪捆绑包的大小"}},[e._v("#")]),e._v(" 跟踪捆绑包的大小")]),e._v(" "),t("p",[e._v("要监视您的应用程序大小，请在开发过程中使用 "),t("a",{attrs:{href:"https://github.com/FormidableLabs/webpack-dashboard/",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack-dashboard"),t("OutboundLink")],1),e._v("并 在CI上"),t("a",{attrs:{href:"https://github.com/siddharthkp/bundlesize",target:"_blank",rel:"noopener noreferrer"}},[e._v("捆绑"),t("OutboundLink")],1),e._v("使用。")]),e._v(" "),t("h3",{attrs:{id:"webpack仪表板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack仪表板"}},[e._v("#")]),e._v(" webpack仪表板")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/FormidableLabs/webpack-dashboard/",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack-dashboard"),t("OutboundLink")],1),e._v("通过依赖项，进度和其他详细信息的大小增强了webpack的输出。外观如下：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://developers.google.cn/web/fundamentals/performance/webpack/webpack-dashboard.png",alt:"webpack-dashboard输出的屏幕截图"}})]),e._v(" "),t("p",[e._v("此仪表板有助于跟踪较大的依赖关系-如果添加一个依赖关系，则将立即在“ *模块”*部分中看到它！")]),e._v(" "),t("p",[e._v("要启用它，请安装"),t("code",[e._v("webpack-dashboard")]),e._v("软件包：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("npm install webpack-dashboard --save-dev\n")])])]),t("p",[e._v("并将插件添加到"),t("code",[e._v("plugins")]),e._v("配置部分：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// webpack.config.js\nconst DashboardPlugin = require('webpack-dashboard/plugin');\n\nmodule.exports = {\n  plugins: [\n    new DashboardPlugin(),\n  ],\n};\n")])])]),t("p",[e._v("或使用（"),t("code",[e._v("compiler.apply()")]),e._v("如果您使用的是基于Express的开发服务器）：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("compiler.apply(new DashboardPlugin());\n")])])]),t("p",[e._v("随意使用仪表板查找可能需要改进的地方！例如，在“ *模块”*部分中滚动查找哪些库太大，可以用较小的替代库替换。")]),e._v(" "),t("h3",{attrs:{id:"捆束大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#捆束大小"}},[e._v("#")]),e._v(" 捆束大小")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/siddharthkp/bundlesize",target:"_blank",rel:"noopener noreferrer"}},[e._v("bundlesize"),t("OutboundLink")],1),e._v("验证webpack资产是否不超过指定的大小。将其与CI集成，以在应用变得太大时得到通知：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://developers.google.cn/web/fundamentals/performance/webpack/bundlesize.jpg",alt:"屏幕快照，是GitHub上pull请求的CI部分。 在CI工具中，有Bundlesize输出"}})]),e._v(" "),t("p",[e._v("要配置它：")]),e._v(" "),t("p",[t("strong",[e._v("找出最大尺寸")])]),e._v(" "),t("ol",[t("li",[t("p",[e._v("优化应用以使其尽可能小。运行生产版本。")])]),e._v(" "),t("li",[t("p",[e._v("将本")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("bundlesize\n")])])]),t("p",[e._v("节添加")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("package.json\n")])])]),t("p",[e._v("以下内容：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// package.json { “ bundlesize ”：[ { “ path ”：“ ./ dist / *”     }   ] }\n \n   \n     \n       \n")])])])]),e._v(" "),t("li")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("bundlesize\n")])])]),t("p",[e._v("用")]),e._v(" "),t("p",[e._v("npx")]),e._v(" "),t("p",[e._v("执行：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("npx bundlesize\n")])])]),t("p",[e._v("这将打印每个文件的压缩大小：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("PASS ./ DIST / icon256 。6168aaac8461862eab7a 。png ：10.89KB  \nPASS ./ dist / icon512 。c3e073a4100bd0c28a86 。PNG ：13.1KB  \nPASS ./ DIST / 主。0c8b617dfc40c2827ae3.js ：16.28KB  \nPASS ./ DIST / 供应商。ff9f7ea865 31.49KB\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[e._v("将每种尺寸加10-20％，即可获得最大尺寸。这10％到20％的利润将让您照常开发应用程序，同时在尺寸太大时警告您。")])]),e._v(" "),t("p",[t("strong",[e._v("启用 "),t("code",[e._v("bundlesize")])])]),e._v(" "),t("ol",[t("li",[t("p",[e._v("将"),t("code",[e._v("bundlesize")]),e._v("软件包安装为开发依赖项：")])]),e._v(" "),t("li",[t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("NPM安装bundlesize - 保存- 开发\n")])])])]),e._v(" "),t("li",[t("p",[e._v("在中的")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("bundlesize\n")])])]),t("p",[e._v("部分中")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("package.json\n")])])]),t("p",[e._v("，指定具体的最大尺寸。对于某些文件（例如图像），您可能需要指定每种文件类型的最大大小，而不是每个文件：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// package.json { “ bundlesize” ：[ { “ path” ：“ ./dist/*.png” ，“ maxSize” ：“ 16 kB” ，}，{ “ path” ：“ ./dist/main.* .js“ ，” maxSize“ ：” 20 kB“ ，}，{ ” path“ ：” ./dist/vendor.*.js“ ，” maxSize“ ：” 35 kB“ ，} ] }\n\n   \n    \n       \n       \n    \n    \n       \n       \n    \n    \n       \n       \n    \n  \n")])])])]),e._v(" "),t("li",[t("p",[e._v("添加一个npm脚本来运行检查：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// package.json { “ scripts” ：{ “ check-size” ：“ bundlesize” } }\n\n   \n     \n  \n")])])])]),e._v(" "),t("li",[t("p",[e._v("配置CI以"),t("code",[e._v("npm run check-size")]),e._v("在每次推送时执行。（如果要在其上开发项目，请"),t("a",{attrs:{href:"https://github.com/siddharthkp/bundlesize#2-build-status",target:"_blank",rel:"noopener noreferrer"}},[e._v(" 与GitHub "),t("OutboundLink")],1),t("a",{attrs:{href:"https://github.com/siddharthkp/bundlesize#2-build-status",target:"_blank",rel:"noopener noreferrer"}},[e._v("集成"),t("code",[e._v("bundlesize")]),t("OutboundLink")],1),e._v("。）")])])]),e._v(" "),t("p",[e._v("而已！现在，如果您运行"),t("code",[e._v("npm run check-size")]),e._v("或推送代码，您将看到输出文件是否足够小：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://developers.google.cn/web/fundamentals/performance/webpack/bundlesize-output-success.png",alt:"bundlesize输出的屏幕截图。 所有构建结果均标有“通过”"}})]),e._v(" "),t("p",[e._v("或者，如果发生故障：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://developers.google.cn/web/fundamentals/performance/webpack/bundlesize-output-failure.png",alt:"bundlesize输出的屏幕截图。 一些构建结果标记为“失败”"}})]),e._v(" "),t("h3",{attrs:{id:"进一步阅读"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进一步阅读"}},[e._v("#")]),e._v(" 进一步阅读")]),e._v(" "),t("ul",[t("li",[e._v("Alex Russell "),t("a",{attrs:{href:"https://infrequently.org/2017/10/can-you-afford-it-real-world-web-performance-budgets/",target:"_blank",rel:"noopener noreferrer"}},[e._v("关于我们应该针对的实际加载时间"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"分析捆绑包为何如此之大"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分析捆绑包为何如此之大"}},[e._v("#")]),e._v(" 分析捆绑包为何如此之大")]),e._v(" "),t("p",[e._v("您可能想更深入地了解捆绑软件，以了解其中包含哪些模块。认识 "),t("a",{attrs:{href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack-bundle-analyzer"),t("OutboundLink")],1),e._v("：")]),e._v(" "),t("p",[t("video",{staticStyle:{"box-sizing":"inherit",border:"0px",height:"auto","max-width":"100%"},attrs:{src:"https://developers.google.cn/web/fundamentals/performance/webpack/webpack-bundle-analyzer.mp4",alt:"webpack捆绑分析器页面的屏幕录像",autoplay:"",controls:"",loop:""}})]),e._v(" "),t("p",[e._v("（截屏来自"),t("a",{attrs:{href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"}},[e._v("github.com/webpack-contrib/webpack-bundle-analyzer"),t("OutboundLink")],1),e._v("）")]),e._v(" "),t("p",[e._v("webpack-bundle-analyzer扫描捆绑软件并对其内部内容进行可视化。使用此可视化来查找较大或不必要的依赖项。")]),e._v(" "),t("p",[e._v("要使用分析仪，请安装"),t("code",[e._v("webpack-bundle-analyzer")]),e._v("软件包：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("npm install webpack-bundle-analyzer --save-dev\n")])])]),t("p",[e._v("将插件添加到webpack配置中：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// webpack.config.js\nconst BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;\n\nmodule.exports = {\n  plugins: [\n    new BundleAnalyzerPlugin(),\n  ],\n};\n")])])]),t("p",[e._v("并运行生产版本。该插件将在浏览器中打开统计信息页面。")]),e._v(" "),t("p",[e._v("默认情况下，“统计信息”页面显示已分析文件（即，文件包中显示的文件）的大小。您可能需要比较gzip的大小，因为这更接近实际用户的体验。使用左侧的侧边栏切换尺寸。")]),e._v(" "),t("p",[e._v("**注意：**如果使用 "),t("a",{attrs:{href:"https://webpack.js.org/plugins/module-concatenation-plugin/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ModuleConcatenationPlugin"),t("OutboundLink")],1),e._v("，它可能会合并webpack-bundle-analyzer输出中的部分模块，从而使报告不太详细。如果您使用此插件，请在分析过程中将其禁用。")]),e._v(" "),t("p",[e._v("在报告中查找的内容如下：")]),e._v(" "),t("ul",[t("li",[e._v("**大的依赖关系。**为什么这么大？是否有较小的替代方案（例如，Preact代替React）？您是否使用了它包含的所有代码（例如，Moment.js包含很多"),t("a",{attrs:{href:"https://github.com/GoogleChromeLabs/webpack-libs-optimizations#moment",target:"_blank",rel:"noopener noreferrer"}},[e._v("经常不使用并且可能会被删除"),t("OutboundLink")],1),e._v("的语言环境 ）？")]),e._v(" "),t("li",[e._v("**重复的依赖项。**您看到同一个库在多个文件中重复吗？（例如，使用"),t("code",[e._v("optimization.splitChunks.chunks")]),e._v("– webpack 4中的选项–或"),t("code",[e._v("CommonsChunkPlugin")]),e._v("–webpack 3中的选项- 将其移动到一个公共文件中。）该捆绑包是否具有同一库的多个版本？")]),e._v(" "),t("li",[e._v("**类似的依赖关系。**是否有类似的库可以完成大约相同的工作？（例如 "),t("code",[e._v("moment")]),e._v("和"),t("code",[e._v("date-fns")]),e._v("，或"),t("code",[e._v("lodash")]),e._v("和"),t("code",[e._v("lodash-es")]),e._v("。）尝试使用单个工具粘贴。")])]),e._v(" "),t("p",[e._v("另外，请查看Sean Larkin "),t("a",{attrs:{href:"https://medium.com/webpack/webpack-bits-getting-the-most-out-of-the-commonschunkplugin-ab389e5f318",target:"_blank",rel:"noopener noreferrer"}},[e._v("对webpack捆绑软件"),t("OutboundLink")],1),e._v("的"),t("a",{attrs:{href:"https://medium.com/webpack/webpack-bits-getting-the-most-out-of-the-commonschunkplugin-ab389e5f318",target:"_blank",rel:"noopener noreferrer"}},[e._v("出色分析"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("h2",{attrs:{id:"加起来"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#加起来"}},[e._v("#")]),e._v(" 加起来")]),e._v(" "),t("ul",[t("li",[e._v("使用"),t("code",[e._v("webpack-dashboard")]),e._v("并"),t("code",[e._v("bundlesize")]),e._v("随时了解您的应用程序的大小")]),e._v(" "),t("li",[e._v("挖掘一下如何建立规模 "),t("code",[e._v("webpack-bundle-analyzer")])])])])}),[],!1,null,null,null);a.default=s.exports}}]);