<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>通过导航和资源定时评估加载性能 | LiYang&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <link rel="preload" href="/assets/css/0.styles.ff3929f5.css" as="style"><link rel="preload" href="/assets/js/app.40794b05.js" as="script"><link rel="preload" href="/assets/js/2.21c2c3d2.js" as="script"><link rel="preload" href="/assets/js/215.0422f8a3.js" as="script"><link rel="prefetch" href="/assets/js/10.058f7072.js"><link rel="prefetch" href="/assets/js/100.f3568421.js"><link rel="prefetch" href="/assets/js/101.3669cd11.js"><link rel="prefetch" href="/assets/js/102.cefa1450.js"><link rel="prefetch" href="/assets/js/103.0fc12baa.js"><link rel="prefetch" href="/assets/js/104.fc75b27c.js"><link rel="prefetch" href="/assets/js/105.9efa40da.js"><link rel="prefetch" href="/assets/js/106.2132845c.js"><link rel="prefetch" href="/assets/js/107.50efbf3f.js"><link rel="prefetch" href="/assets/js/108.2e4d6b56.js"><link rel="prefetch" href="/assets/js/109.362f4964.js"><link rel="prefetch" href="/assets/js/11.acbb83b6.js"><link rel="prefetch" href="/assets/js/110.260ecf9d.js"><link rel="prefetch" href="/assets/js/111.ac0ed6b0.js"><link rel="prefetch" href="/assets/js/112.e26ce83f.js"><link rel="prefetch" href="/assets/js/113.c17594f4.js"><link rel="prefetch" href="/assets/js/114.081ea0e8.js"><link rel="prefetch" href="/assets/js/115.9f1c1fc5.js"><link rel="prefetch" href="/assets/js/116.300e5c32.js"><link rel="prefetch" href="/assets/js/117.005796a9.js"><link rel="prefetch" href="/assets/js/118.5dd34410.js"><link rel="prefetch" href="/assets/js/119.2a52edee.js"><link rel="prefetch" href="/assets/js/12.f5d0a92b.js"><link rel="prefetch" href="/assets/js/120.2692504f.js"><link rel="prefetch" href="/assets/js/121.de91fbab.js"><link rel="prefetch" href="/assets/js/122.8fe54cb7.js"><link rel="prefetch" href="/assets/js/123.27f7de3d.js"><link rel="prefetch" href="/assets/js/124.df486141.js"><link rel="prefetch" href="/assets/js/125.b3333a19.js"><link rel="prefetch" href="/assets/js/126.0252235d.js"><link rel="prefetch" href="/assets/js/127.e416e0cb.js"><link rel="prefetch" href="/assets/js/128.80fc9ce8.js"><link rel="prefetch" href="/assets/js/129.d549459c.js"><link rel="prefetch" href="/assets/js/13.c75b92e4.js"><link rel="prefetch" href="/assets/js/130.535fd734.js"><link rel="prefetch" href="/assets/js/131.9d165e98.js"><link rel="prefetch" href="/assets/js/132.ef795834.js"><link rel="prefetch" href="/assets/js/133.2044b8d2.js"><link rel="prefetch" href="/assets/js/134.ea0aee7d.js"><link rel="prefetch" href="/assets/js/135.6f39d3e5.js"><link rel="prefetch" href="/assets/js/136.47dc0812.js"><link rel="prefetch" href="/assets/js/137.3eaf9788.js"><link rel="prefetch" href="/assets/js/138.1135d0ed.js"><link rel="prefetch" href="/assets/js/139.d546d7cb.js"><link rel="prefetch" href="/assets/js/14.1114043e.js"><link rel="prefetch" href="/assets/js/140.aae58cac.js"><link rel="prefetch" href="/assets/js/141.b8b72927.js"><link rel="prefetch" href="/assets/js/142.b161cba1.js"><link rel="prefetch" href="/assets/js/143.cfb7b204.js"><link rel="prefetch" href="/assets/js/144.818c2cff.js"><link rel="prefetch" href="/assets/js/145.60f90c39.js"><link rel="prefetch" href="/assets/js/146.7ddef663.js"><link rel="prefetch" href="/assets/js/147.06d1017e.js"><link rel="prefetch" href="/assets/js/148.c7c411a0.js"><link rel="prefetch" href="/assets/js/149.334bd804.js"><link rel="prefetch" href="/assets/js/15.3f0b462f.js"><link rel="prefetch" href="/assets/js/150.7c8c73b7.js"><link rel="prefetch" href="/assets/js/151.62d10d6c.js"><link rel="prefetch" href="/assets/js/152.82e28168.js"><link rel="prefetch" href="/assets/js/153.e1ee4321.js"><link rel="prefetch" href="/assets/js/154.f576cc10.js"><link rel="prefetch" href="/assets/js/155.964a90f2.js"><link rel="prefetch" href="/assets/js/156.4bdc75f5.js"><link rel="prefetch" href="/assets/js/157.6581cb30.js"><link rel="prefetch" href="/assets/js/158.24f9817a.js"><link rel="prefetch" href="/assets/js/159.89915418.js"><link rel="prefetch" href="/assets/js/16.d8001a48.js"><link rel="prefetch" href="/assets/js/160.643f5b36.js"><link rel="prefetch" href="/assets/js/161.4714f73e.js"><link rel="prefetch" href="/assets/js/162.7527446c.js"><link rel="prefetch" href="/assets/js/163.229f891d.js"><link rel="prefetch" href="/assets/js/164.429d3070.js"><link rel="prefetch" href="/assets/js/165.5e342261.js"><link rel="prefetch" href="/assets/js/166.f0cb088a.js"><link rel="prefetch" href="/assets/js/167.40a0038b.js"><link rel="prefetch" href="/assets/js/168.758c8238.js"><link rel="prefetch" href="/assets/js/169.a972a570.js"><link rel="prefetch" href="/assets/js/17.8a850ded.js"><link rel="prefetch" href="/assets/js/170.0fba2db3.js"><link rel="prefetch" href="/assets/js/171.43f66f94.js"><link rel="prefetch" href="/assets/js/172.9467deb8.js"><link rel="prefetch" href="/assets/js/173.26fef872.js"><link rel="prefetch" href="/assets/js/174.0958a150.js"><link rel="prefetch" href="/assets/js/175.a87b0ab5.js"><link rel="prefetch" href="/assets/js/176.04363b06.js"><link rel="prefetch" href="/assets/js/177.34672e1c.js"><link rel="prefetch" href="/assets/js/178.42e0456b.js"><link rel="prefetch" href="/assets/js/179.ec648519.js"><link rel="prefetch" href="/assets/js/18.fe4d545b.js"><link rel="prefetch" href="/assets/js/180.8a5fc825.js"><link rel="prefetch" href="/assets/js/181.3dabf704.js"><link rel="prefetch" href="/assets/js/182.e1193960.js"><link rel="prefetch" href="/assets/js/183.975cb0ee.js"><link rel="prefetch" href="/assets/js/184.a0e65b8e.js"><link rel="prefetch" href="/assets/js/185.1b24284f.js"><link rel="prefetch" href="/assets/js/186.9f5186d0.js"><link rel="prefetch" href="/assets/js/187.7b2b6fb4.js"><link rel="prefetch" href="/assets/js/188.39449f6c.js"><link rel="prefetch" href="/assets/js/189.d6c034d8.js"><link rel="prefetch" href="/assets/js/19.48cc10f6.js"><link rel="prefetch" href="/assets/js/190.2fe5508a.js"><link rel="prefetch" href="/assets/js/191.368805e9.js"><link rel="prefetch" href="/assets/js/192.8351a6ec.js"><link rel="prefetch" href="/assets/js/193.4d86bf98.js"><link rel="prefetch" href="/assets/js/194.86d3a829.js"><link rel="prefetch" href="/assets/js/195.931ce7ef.js"><link rel="prefetch" href="/assets/js/196.35818a22.js"><link rel="prefetch" href="/assets/js/197.109eef6d.js"><link rel="prefetch" href="/assets/js/198.a092c6d3.js"><link rel="prefetch" href="/assets/js/199.0a7aea6b.js"><link rel="prefetch" href="/assets/js/20.1baf39d0.js"><link rel="prefetch" href="/assets/js/200.eb75a43c.js"><link rel="prefetch" href="/assets/js/201.167f1a27.js"><link rel="prefetch" href="/assets/js/202.80380232.js"><link rel="prefetch" href="/assets/js/203.dfb07860.js"><link rel="prefetch" href="/assets/js/204.0de5d7ad.js"><link rel="prefetch" href="/assets/js/205.da83ee83.js"><link rel="prefetch" href="/assets/js/206.4ff75723.js"><link rel="prefetch" href="/assets/js/207.c0023a8f.js"><link rel="prefetch" href="/assets/js/208.e1d257d1.js"><link rel="prefetch" href="/assets/js/209.668018f6.js"><link rel="prefetch" href="/assets/js/21.b0e0d339.js"><link rel="prefetch" href="/assets/js/210.eac594b9.js"><link rel="prefetch" href="/assets/js/211.1cc3154f.js"><link rel="prefetch" href="/assets/js/212.0a3e0704.js"><link rel="prefetch" href="/assets/js/213.e5257a7e.js"><link rel="prefetch" href="/assets/js/214.a335e108.js"><link rel="prefetch" href="/assets/js/216.6e63fc29.js"><link rel="prefetch" href="/assets/js/217.a38e1ca8.js"><link rel="prefetch" href="/assets/js/218.04c38c96.js"><link rel="prefetch" href="/assets/js/219.89a7899f.js"><link rel="prefetch" href="/assets/js/22.f5c6b71f.js"><link rel="prefetch" href="/assets/js/220.02a01cb8.js"><link rel="prefetch" href="/assets/js/221.e0eded2d.js"><link rel="prefetch" href="/assets/js/222.06c16e31.js"><link rel="prefetch" href="/assets/js/223.a4b75ccb.js"><link rel="prefetch" href="/assets/js/224.9129f3cf.js"><link rel="prefetch" href="/assets/js/225.1c089563.js"><link rel="prefetch" href="/assets/js/226.8d7ae032.js"><link rel="prefetch" href="/assets/js/227.3bfa4328.js"><link rel="prefetch" href="/assets/js/228.a1748bdf.js"><link rel="prefetch" href="/assets/js/229.c1c27996.js"><link rel="prefetch" href="/assets/js/23.265953eb.js"><link rel="prefetch" href="/assets/js/230.f39a1f48.js"><link rel="prefetch" href="/assets/js/231.ca132071.js"><link rel="prefetch" href="/assets/js/232.9ca5e931.js"><link rel="prefetch" href="/assets/js/233.e04e254f.js"><link rel="prefetch" href="/assets/js/234.22381aab.js"><link rel="prefetch" href="/assets/js/235.6bc8508d.js"><link rel="prefetch" href="/assets/js/236.5914c9a6.js"><link rel="prefetch" href="/assets/js/237.a721ad82.js"><link rel="prefetch" href="/assets/js/238.af3e025d.js"><link rel="prefetch" href="/assets/js/239.44fe29c9.js"><link rel="prefetch" href="/assets/js/24.16fb3de9.js"><link rel="prefetch" href="/assets/js/240.9ba57538.js"><link rel="prefetch" href="/assets/js/241.46a9cb7e.js"><link rel="prefetch" href="/assets/js/242.ae70539b.js"><link rel="prefetch" href="/assets/js/243.8a1feaf8.js"><link rel="prefetch" href="/assets/js/244.cdbaaca6.js"><link rel="prefetch" href="/assets/js/245.7117eda6.js"><link rel="prefetch" href="/assets/js/246.742dd686.js"><link rel="prefetch" href="/assets/js/247.7046d3e0.js"><link rel="prefetch" href="/assets/js/248.dbd8407d.js"><link rel="prefetch" href="/assets/js/249.206b660b.js"><link rel="prefetch" href="/assets/js/25.21d0c0dd.js"><link rel="prefetch" href="/assets/js/250.f559b400.js"><link rel="prefetch" href="/assets/js/251.f13bd91c.js"><link rel="prefetch" href="/assets/js/252.aaa10b65.js"><link rel="prefetch" href="/assets/js/253.78640ae7.js"><link rel="prefetch" href="/assets/js/254.5251f555.js"><link rel="prefetch" href="/assets/js/255.5f8655e1.js"><link rel="prefetch" href="/assets/js/256.0b1da59b.js"><link rel="prefetch" href="/assets/js/257.c4b311d3.js"><link rel="prefetch" href="/assets/js/258.62c44f28.js"><link rel="prefetch" href="/assets/js/259.7a8ecb77.js"><link rel="prefetch" href="/assets/js/26.68bfb3cd.js"><link rel="prefetch" href="/assets/js/260.9506bc77.js"><link rel="prefetch" href="/assets/js/261.ab6ac9b0.js"><link rel="prefetch" href="/assets/js/262.6f237036.js"><link rel="prefetch" href="/assets/js/27.e08c2734.js"><link rel="prefetch" href="/assets/js/28.d05f086f.js"><link rel="prefetch" href="/assets/js/29.14bacba0.js"><link rel="prefetch" href="/assets/js/3.9859aeed.js"><link rel="prefetch" href="/assets/js/30.d1c1c795.js"><link rel="prefetch" href="/assets/js/31.c464fa16.js"><link rel="prefetch" href="/assets/js/32.74ae82b3.js"><link rel="prefetch" href="/assets/js/33.6d39a197.js"><link rel="prefetch" href="/assets/js/34.a5448e75.js"><link rel="prefetch" href="/assets/js/35.e677db99.js"><link rel="prefetch" href="/assets/js/36.9373382d.js"><link rel="prefetch" href="/assets/js/37.aaef6158.js"><link rel="prefetch" href="/assets/js/38.b8534a41.js"><link rel="prefetch" href="/assets/js/39.8e5ecefa.js"><link rel="prefetch" href="/assets/js/4.b3a2afa1.js"><link rel="prefetch" href="/assets/js/40.0fbf1e24.js"><link rel="prefetch" href="/assets/js/41.b68829b1.js"><link rel="prefetch" href="/assets/js/42.c6327e05.js"><link rel="prefetch" href="/assets/js/43.5cdcb8f5.js"><link rel="prefetch" href="/assets/js/44.48fd0994.js"><link rel="prefetch" href="/assets/js/45.45e8d731.js"><link rel="prefetch" href="/assets/js/46.ea182d63.js"><link rel="prefetch" href="/assets/js/47.3d1bf5d3.js"><link rel="prefetch" href="/assets/js/48.485f3e01.js"><link rel="prefetch" href="/assets/js/49.a2622af2.js"><link rel="prefetch" href="/assets/js/5.ddbdceff.js"><link rel="prefetch" href="/assets/js/50.572052eb.js"><link rel="prefetch" href="/assets/js/51.ed257c0f.js"><link rel="prefetch" href="/assets/js/52.23b18f3a.js"><link rel="prefetch" href="/assets/js/53.14b56cb4.js"><link rel="prefetch" href="/assets/js/54.bb07175e.js"><link rel="prefetch" href="/assets/js/55.d48bde66.js"><link rel="prefetch" href="/assets/js/56.38433979.js"><link rel="prefetch" href="/assets/js/57.99b13154.js"><link rel="prefetch" href="/assets/js/58.498c71ad.js"><link rel="prefetch" href="/assets/js/59.24e06284.js"><link rel="prefetch" href="/assets/js/6.cae33779.js"><link rel="prefetch" href="/assets/js/60.fe0260d5.js"><link rel="prefetch" href="/assets/js/61.b5bcfd89.js"><link rel="prefetch" href="/assets/js/62.bdc41a00.js"><link rel="prefetch" href="/assets/js/63.10468463.js"><link rel="prefetch" href="/assets/js/64.028e0281.js"><link rel="prefetch" href="/assets/js/65.f762d4ff.js"><link rel="prefetch" href="/assets/js/66.33239ba5.js"><link rel="prefetch" href="/assets/js/67.c89232f4.js"><link rel="prefetch" href="/assets/js/68.e2ab181e.js"><link rel="prefetch" href="/assets/js/69.86594af5.js"><link rel="prefetch" href="/assets/js/7.5bd7e1fe.js"><link rel="prefetch" href="/assets/js/70.f79bf73b.js"><link rel="prefetch" href="/assets/js/71.36d10bfe.js"><link rel="prefetch" href="/assets/js/72.85d3c063.js"><link rel="prefetch" href="/assets/js/73.4746e647.js"><link rel="prefetch" href="/assets/js/74.c8d81312.js"><link rel="prefetch" href="/assets/js/75.dd1ae94f.js"><link rel="prefetch" href="/assets/js/76.b06cc20c.js"><link rel="prefetch" href="/assets/js/77.855f7650.js"><link rel="prefetch" href="/assets/js/78.4e5b0253.js"><link rel="prefetch" href="/assets/js/79.95567ab3.js"><link rel="prefetch" href="/assets/js/8.62836d81.js"><link rel="prefetch" href="/assets/js/80.7b7033a0.js"><link rel="prefetch" href="/assets/js/81.45b93100.js"><link rel="prefetch" href="/assets/js/82.36d8eb8a.js"><link rel="prefetch" href="/assets/js/83.b361b85d.js"><link rel="prefetch" href="/assets/js/84.2e4874fa.js"><link rel="prefetch" href="/assets/js/85.272cfc57.js"><link rel="prefetch" href="/assets/js/86.aaa56439.js"><link rel="prefetch" href="/assets/js/87.dc9e3259.js"><link rel="prefetch" href="/assets/js/88.689b6a8b.js"><link rel="prefetch" href="/assets/js/89.f22e017d.js"><link rel="prefetch" href="/assets/js/9.584f1ef6.js"><link rel="prefetch" href="/assets/js/90.d0ed3f12.js"><link rel="prefetch" href="/assets/js/91.21868b2f.js"><link rel="prefetch" href="/assets/js/92.0b1bc56b.js"><link rel="prefetch" href="/assets/js/93.9fd7ccef.js"><link rel="prefetch" href="/assets/js/94.5cee5367.js"><link rel="prefetch" href="/assets/js/95.c81773d8.js"><link rel="prefetch" href="/assets/js/96.c8f61d95.js"><link rel="prefetch" href="/assets/js/97.f86ea530.js"><link rel="prefetch" href="/assets/js/98.09c0fa30.js"><link rel="prefetch" href="/assets/js/99.c4bd6444.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ff3929f5.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.svg" alt="LiYang's blog" class="logo"> <span class="site-name can-hide">LiYang's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/pages/0a6679/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0a6679/" class="nav-link">编程基础</a></li><li class="dropdown-item"><!----> <a href="/pages/714859/" class="nav-link">开发软件</a></li><li class="dropdown-item"><!----> <a href="/pages/690ae0/" class="nav-link">类库框架</a></li><li class="dropdown-item"><!----> <a href="/pages/d2dd63/" class="nav-link">知识进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/fd695e/" class="nav-link">工程开发</a></li><li class="dropdown-item"><!----> <a href="/pages/f37132/" class="nav-link">编程思想</a></li><li class="dropdown-item"><!----> <a href="/pages/73d90e/" class="nav-link">领域分支</a></li><li class="dropdown-item"><!----> <a href="/pages/b7eb61/" class="nav-link">社区发展</a></li><li class="dropdown-item"><!----> <a href="/pages/83b440/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/pages/0d54d7/" class="nav-link">后端知识</a></li><li class="dropdown-item"><!----> <a href="/pages/416bc0/" class="nav-link">软技能</a></li></ul></div></div><div class="nav-item"><a href="/leetCode/" class="nav-link">🤡LeetCode</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记本" class="dropdown-title"><a href="/notes/" class="link-title">笔记本</a> <span class="title" style="display:none;">笔记本</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>书籍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/es6/" class="nav-link">《ES6教程》</a></li><li class="dropdown-subitem"><a href="/books/professionalJs/" class="nav-link">《JavaScript高级程序设计》</a></li></ul></li><li class="dropdown-item"><h4>教程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/course/css3-jspang/" class="nav-link">CSS3(技术胖)</a></li><li class="dropdown-subitem"><a href="/course/es6-jspang/" class="nav-link">ES6(技术胖)</a></li><li class="dropdown-subitem"><a href="/course/performance/" class="nav-link">性能(Google Developers)</a></li></ul></li><li class="dropdown-item"><h4>技术文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/200943/.html" class="nav-link">leaflet中文教程</a></li></ul></li></ul></div></div> <a href="https://github.com/fineliving" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200103123203.jpg"> <div class="blogger-info"><h3>Evan Xu</h3> <span>前端界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/pages/0a6679/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0a6679/" class="nav-link">编程基础</a></li><li class="dropdown-item"><!----> <a href="/pages/714859/" class="nav-link">开发软件</a></li><li class="dropdown-item"><!----> <a href="/pages/690ae0/" class="nav-link">类库框架</a></li><li class="dropdown-item"><!----> <a href="/pages/d2dd63/" class="nav-link">知识进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/fd695e/" class="nav-link">工程开发</a></li><li class="dropdown-item"><!----> <a href="/pages/f37132/" class="nav-link">编程思想</a></li><li class="dropdown-item"><!----> <a href="/pages/73d90e/" class="nav-link">领域分支</a></li><li class="dropdown-item"><!----> <a href="/pages/b7eb61/" class="nav-link">社区发展</a></li><li class="dropdown-item"><!----> <a href="/pages/83b440/" class="nav-link">计算机基础</a></li><li class="dropdown-item"><!----> <a href="/pages/0d54d7/" class="nav-link">后端知识</a></li><li class="dropdown-item"><!----> <a href="/pages/416bc0/" class="nav-link">软技能</a></li></ul></div></div><div class="nav-item"><a href="/leetCode/" class="nav-link">🤡LeetCode</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记本" class="dropdown-title"><a href="/notes/" class="link-title">笔记本</a> <span class="title" style="display:none;">笔记本</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>书籍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/es6/" class="nav-link">《ES6教程》</a></li><li class="dropdown-subitem"><a href="/books/professionalJs/" class="nav-link">《JavaScript高级程序设计》</a></li></ul></li><li class="dropdown-item"><h4>教程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/course/css3-jspang/" class="nav-link">CSS3(技术胖)</a></li><li class="dropdown-subitem"><a href="/course/es6-jspang/" class="nav-link">ES6(技术胖)</a></li><li class="dropdown-subitem"><a href="/course/performance/" class="nav-link">性能(Google Developers)</a></li></ul></li><li class="dropdown-item"><h4>技术文档</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/200943/.html" class="nav-link">leaflet中文教程</a></li></ul></li></ul></div></div> <a href="https://github.com/fineliving" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/932a6d/" class="sidebar-link">性能为何至关重要</a></li><li><a href="/pages/5c6fa0/" class="sidebar-link">使用 RAIL 模型评估性能</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>加载性能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/3da005/" class="sidebar-link">总览</a></li><li><a href="/pages/5af7d4/" class="sidebar-link">如何测量速度？</a></li><li><a href="/pages/7c5d18/" class="sidebar-link">文字内容</a></li><li><a href="/pages/79cdb9/" class="sidebar-link">图形内容</a></li><li><a href="/pages/f4a116/" class="sidebar-link">HTTP请求</a></li><li><a href="/pages/998cd7/" class="sidebar-link">HTTP缓存</a></li><li><a href="/pages/cb3ca9/" class="sidebar-link">总结和演示</a></li><li><a href="/pages/ed916f/" class="sidebar-link">速度工具</a></li><li><a href="/pages/200943/" aria-current="page" class="active sidebar-link">通过导航和资源定时评估加载性能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/200943/#简单的-api-可帮助您了解浏览器中的网络请求" class="sidebar-link">简单的 API 可帮助您了解浏览器中的网络请求</a></li><li class="sidebar-sub-header"><a href="/pages/200943/#网络请求的寿命和时间" class="sidebar-link">网络请求的寿命和时间</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/200943/#dns-查询" class="sidebar-link">DNS 查询</a></li><li class="sidebar-sub-header"><a href="/pages/200943/#连接协商" class="sidebar-link">连接协商</a></li><li class="sidebar-sub-header"><a href="/pages/200943/#要求和回应" class="sidebar-link">要求和回应</a></li><li class="sidebar-sub-header"><a href="/pages/200943/#其他的东西" class="sidebar-link">其他的东西</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/200943/#在应用程序代码中获取时间" class="sidebar-link">在应用程序代码中获取时间</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/200943/#其他手动获取时间的方法" class="sidebar-link">其他手动获取时间的方法</a></li><li class="sidebar-sub-header"><a href="/pages/200943/#使用-performanceobserver-收听性能条目" class="sidebar-link">使用 PerformanceObserver 收听性能条目</a></li><li class="sidebar-sub-header"><a href="/pages/200943/#陷阱" class="sidebar-link">陷阱</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/200943/#给家里打电话" class="sidebar-link">给家里打电话</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/200943/#使用-navigator-sendbeacon" class="sidebar-link">使用 navigator.sendBeacon</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/200943/#包起来" class="sidebar-link">包起来</a></li></ul></li><li><a href="/pages/13c2e2/" class="sidebar-link">以用户为中心的性能指标</a></li><li><a href="/pages/30d447/" class="sidebar-link">了解低带宽和高延迟</a></li><li><a href="/pages/029c6a/" class="sidebar-link">优化内容效率</a></li><li><a href="/pages/1c8f87/" class="sidebar-link">避免不必要的下载</a></li><li><a href="/pages/9c6617/" class="sidebar-link">优化基于文本的资产的编码和传送大小</a></li><li><a href="/pages/000317/" class="sidebar-link">JavaScript启动优化</a></li><li><a href="/pages/d9771b/" class="sidebar-link">加载第三方JavaScript</a></li><li><a href="/pages/16e316/" class="sidebar-link">网页字体优化</a></li><li><a href="/pages/0497ba/" class="sidebar-link">通过客户提示适应用户</a></li><li><a href="/pages/d34d56/" class="sidebar-link">通过保存数据交付快速轻便的应用程序</a></li><li><a href="/pages/b5f9f1/" class="sidebar-link">通过摇树来减少JavaScript负载</a></li><li><a href="/pages/a0ed26/" class="sidebar-link">离线指南</a></li><li><a href="/pages/690a1a/" class="sidebar-link">网页存储概览</a></li><li><a href="/pages/b84219/" class="sidebar-link">使用IndexedDB的最佳实践</a></li><li><a href="/pages/65f486/" class="sidebar-link">Offline UX 注意事项</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>精心安排加载</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/371041/" class="sidebar-link">关键渲染路径</a></li><li><a href="/pages/f31118/" class="sidebar-link">构建对象模型</a></li><li><a href="/pages/739b11/" class="sidebar-link">渲染树构建、布局及绘制</a></li><li><a href="/pages/b9d842/" class="sidebar-link">阻塞渲染的CSS</a></li><li><a href="/pages/f005c3/" class="sidebar-link">使用JavaScript添加交互</a></li><li><a href="/pages/1d7873/" class="sidebar-link">评估关键渲染路径</a></li><li><a href="/pages/3b99f9/" class="sidebar-link">分析关键渲染路径性能</a></li><li><a href="/pages/0c6644/" class="sidebar-link">优化关键渲染路径</a></li><li><a href="/pages/baf7eb/" class="sidebar-link">PageSpeed规则和建议</a></li><li><a href="/pages/4f4df7/" class="sidebar-link">HTTP/2简介</a></li><li><a href="/pages/65a803/" class="sidebar-link">使用PRPL模式应用即时加载</a></li><li><a href="/pages/08c756/" class="sidebar-link">资源优先级–让浏览器助您一臂之力</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>利用webpack优化web性能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/c18ffb/" class="sidebar-link">介绍</a></li><li><a href="/pages/ec3b6e/" class="sidebar-link">减小前端大小</a></li><li><a href="/pages/8bf683/" class="sidebar-link">利用长期缓存</a></li><li><a href="/pages/0e8875/" class="sidebar-link">monitor-and-analyze</a></li><li><a href="/pages/7cfdc0/" class="sidebar-link">结论</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>渲染性能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/7f377b/" class="sidebar-link">渲染性能</a></li><li><a href="/pages/ccf0ef/" class="sidebar-link">优化JavaScript执行</a></li><li><a href="/pages/bdf4e6/" class="sidebar-link">缩小样式计算的范围并降低其复杂性</a></li><li><a href="/pages/270241/" class="sidebar-link">简化绘制的复杂度、减小绘制区域</a></li><li><a href="/pages/ad1d46/" class="sidebar-link">坚持仅合成器的属性和管理层计数</a></li><li><a href="/pages/de7324/" class="sidebar-link">使输入处理程序去除抖动</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>审核网站</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/29e252/" class="sidebar-link">审核</a></li><li><a href="/pages/ec49df/" class="sidebar-link">准备工作</a></li><li><a href="/pages/c4f089/" class="sidebar-link">检查网站安全</a></li><li><a href="/pages/b7e0b0/" class="sidebar-link">测量性能工具</a></li><li><a href="/pages/bac92b/" class="sidebar-link">分享结果</a></li><li><a href="/pages/e05301/" class="sidebar-link">下一步</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/course/performance" title="《性能(Google Developers)》-目录页" data-v-1cd794fe>《性能(Google Developers)》</a></li> <li data-v-1cd794fe><a href="/course/performance/#加载性能" title="《性能(Google Developers)》#加载性能" data-v-1cd794fe>加载性能</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/fineliving" target="_blank" title="作者" class="beLink" data-v-1cd794fe>Li Yang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2020-11-20</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          通过导航和资源定时评估加载性能
        </h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="通过导航和资源定时评估加载性能"><a href="#通过导航和资源定时评估加载性能" class="header-anchor">#</a> 通过导航和资源定时评估加载性能</h1> <p>您很有可能在某个时候打开了浏览器的开发工具，使用<a href="https://developers.google.cn/web/tools/chrome-devtools/network-performance" target="_blank" rel="noopener noreferrer">network panel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（甚至可能是 <a href="https://developers.google.cn/web/tools/lighthouse" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）来评估性能，并发现了改进的机会。然后，您重构了代码，提高了性能，观看了指标的改进，并向自己表示了祝贺。做得好！</p> <p>只有您还<em>没有</em>完成，因为问题仍然存在：您执行的测试是<a href="https://developers.google.cn/web/fundamentals/performance/speed-tools#lab_data" target="_blank" rel="noopener noreferrer">synthetic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>测试 。他们没有告诉您您的网站<a href="https://developers.google.cn/web/fundamentals/performance/speed-tools#field_data" target="_blank" rel="noopener noreferrer">在该领域<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>对<a href="https://developers.google.cn/web/fundamentals/performance/speed-tools#field_data" target="_blank" rel="noopener noreferrer">真实用户的<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>表现如何。</p> <p>并不是说综合测试很<em>糟糕</em>，而是它只是更大的加载性能图的一部分。不管您使用多少个综合测试工具，它们都只能从一个角度提供数据：从任何设备和网络连接运行测试。当然，基于综合测试建议所做的改进将对所有用户有所帮助，但是只要综合测试仍然是您唯一的性能衡量策略，您在<em>多大程度上</em>都不了解。</p> <p>这是真正用户监视（RUM）的地方。RUM 依靠浏览器中的 JavaScript API 来收集有关网站对<em>真实用户的</em>表现的统计信息。两种特定的 API 通过捕获 可测量资源加载各个阶段的<a href="https://developers.google.cn/web/updates/2012/08/When-milliseconds-are-not-enough-performance-now" target="_blank" rel="noopener noreferrer">高分辨率时序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来衡量用户如何快速加载文档和资源。这些是网络和资源定时 API，本指南将帮助您理解它们提供的数据。</p> <h2 id="简单的-api-可帮助您了解浏览器中的网络请求"><a href="#简单的-api-可帮助您了解浏览器中的网络请求" class="header-anchor">#</a> 简单的 API 可帮助您了解浏览器中的网络请求</h2> <p>导航和资源计时相互之间有很大的重叠，但是它们各自收集不同方面的指标：</p> <ul><li><a href="https://w3c.github.io/navigation-timing/" target="_blank" rel="noopener noreferrer"><strong>导航计时</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>收集 HTML 文档的性能指标。</li> <li><a href="https://w3c.github.io/resource-timing/" target="_blank" rel="noopener noreferrer"><strong>资源计时</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>收集文档相关资源的性能指标。东西像样式表，脚本，图片，<em>等等</em>。</li></ul> <p>如果您对这两个 API 一无所知，您可能会因为过于复杂或不必要而将其清除。事实是，从这些 API 中<em>获取</em>数据很容易，并且该数据对于衡量实际用户的加载性能<em>至关重要</em>。该<em>硬</em>的部分是他们提供的数据的意义，但我们会覆盖所有的很快。现在，让我们在控制台中进行一些实验。</p> <p>导航和资源计时（以及其他相关 API）将<em>性能条目</em>存储 在<em>性能条目缓冲区中</em>。简单来说，这意味着它们将页面和资源的性能指标存储到 JavaScript 可访问的列表中。这些方法存在于<code>window.performance</code> 名称空间中，它们以不同的方式帮助我们查询此列表。不过，现在让我们保持简单并坚持使用<a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByType" target="_blank" rel="noopener noreferrer"><code>getEntriesByType</code> method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。首先，在浏览器中加载任何页面，打开控制台，然后输入以下两个命令之一（或两个都输入）：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Get Navigation Timing entries:</span>
performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span>

<span class="token comment">// Get Resource Timing entries:</span>
performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'resource'</span><span class="token punctuation">)</span>
</code></pre></div><p><code>getEntriesByType</code>接受描述所需条目类型的字符串。要获取导航时间条目，请使用<code>&quot;navigation&quot;</code>。对于资源计时条目，使用<code>&quot;resource&quot;</code>。运行此命令后，您将看到一个数组，其中包含当前页面的性能计时对象，如下所示：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;connectEnd&quot;</span><span class="token operator">:</span> <span class="token number">152.20000001136214</span><span class="token punctuation">,</span>
  <span class="token string">&quot;connectStart&quot;</span><span class="token operator">:</span> <span class="token number">85.00000007916242</span><span class="token punctuation">,</span>
  <span class="token string">&quot;decodedBodySize&quot;</span><span class="token operator">:</span> <span class="token number">1270</span><span class="token punctuation">,</span>
  <span class="token string">&quot;domComplete&quot;</span><span class="token operator">:</span> <span class="token number">377.90000007953495</span><span class="token punctuation">,</span>
  <span class="token string">&quot;domContentLoadedEventEnd&quot;</span><span class="token operator">:</span> <span class="token number">236.4000000525266</span><span class="token punctuation">,</span>
  <span class="token string">&quot;domContentLoadedEventStart&quot;</span><span class="token operator">:</span> <span class="token number">236.4000000525266</span><span class="token punctuation">,</span>
  <span class="token string">&quot;domInteractive&quot;</span><span class="token operator">:</span> <span class="token number">236.2999999895692</span><span class="token punctuation">,</span>
  <span class="token string">&quot;domainLookupEnd&quot;</span><span class="token operator">:</span> <span class="token number">85.00000007916242</span><span class="token punctuation">,</span>
  <span class="token string">&quot;domainLookupStart&quot;</span><span class="token operator">:</span> <span class="token number">64.4000000320375</span><span class="token punctuation">,</span>
  <span class="token string">&quot;duration&quot;</span><span class="token operator">:</span> <span class="token number">377.90000007953495</span><span class="token punctuation">,</span>
  <span class="token string">&quot;encodedBodySize&quot;</span><span class="token operator">:</span> <span class="token number">606</span><span class="token punctuation">,</span>
  <span class="token string">&quot;entryType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;navigation&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;fetchStart&quot;</span><span class="token operator">:</span> <span class="token number">61.600000015459955</span><span class="token punctuation">,</span>
  <span class="token string">&quot;initiatorType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;navigation&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;loadEventEnd&quot;</span><span class="token operator">:</span> <span class="token number">377.90000007953495</span><span class="token punctuation">,</span>
  <span class="token string">&quot;loadEventStart&quot;</span><span class="token operator">:</span> <span class="token number">377.90000007953495</span><span class="token punctuation">,</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://example.com/&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;nextHopProtocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;h2&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;redirectCount&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;redirectEnd&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;redirectStart&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;requestStart&quot;</span><span class="token operator">:</span> <span class="token number">152.50000008381903</span><span class="token punctuation">,</span>
  <span class="token string">&quot;responseEnd&quot;</span><span class="token operator">:</span> <span class="token number">197.80000008177012</span><span class="token punctuation">,</span>
  <span class="token string">&quot;responseStart&quot;</span><span class="token operator">:</span> <span class="token number">170.00000004190952</span><span class="token punctuation">,</span>
  <span class="token string">&quot;secureConnectionStart&quot;</span><span class="token operator">:</span> <span class="token number">105.80000001937151</span><span class="token punctuation">,</span>
  <span class="token string">&quot;startTime&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;transferSize&quot;</span><span class="token operator">:</span> <span class="token number">789</span><span class="token punctuation">,</span>
  <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;navigate&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;unloadEventEnd&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;unloadEventStart&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string">&quot;workerStart&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这些信息的密度可能令人不知所措，但请记住一件事：每当您看到瀑布图时，您都在查看这些 API 提供的数据的直观表示！实际上，可以使用此数据生成自己的视觉效果。例如<a href="https://twitter.com/AndyDavies" target="_blank" rel="noopener noreferrer">安迪·戴维斯<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（<a href="https://twitter.com/AndyDavies" target="_blank" rel="noopener noreferrer">Andy Davies）的<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://github.com/andydavies/waterfall" target="_blank" rel="noopener noreferrer">Waterfall（瀑布<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://twitter.com/AndyDavies" target="_blank" rel="noopener noreferrer">）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>或 <a href="https://twitter.com/micmro" target="_blank" rel="noopener noreferrer">Michael Mrowetz<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（ <a href="https://twitter.com/micmro" target="_blank" rel="noopener noreferrer">Michael Mrowetz）的<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://github.com/micmro/performance-bookmarklet" target="_blank" rel="noopener noreferrer">Performance-Bookmarklet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等脚本就是很好的例子 。</p> <p><img src="https://developers.google.cn/web/fundamentals/performance/navigation-and-resource-timing/images/figure-1-1x.png" alt="由安迪·戴维斯（Andy Davies）创建的Waterfall（瀑布）小书签可视化的资源时间列表。"><strong>图 1</strong>。显示页面及其资源计时的 Waterfall 小书签。</p> <p>导航和资源定时是可以帮助您衡量加载内容所需时间的 API。由于这些 API 是 JavaScript 的一部分，因此您可以使用它们来收集用户访问页面时的重要性能统计信息。那是强大的东西！</p> <h2 id="网络请求的寿命和时间"><a href="#网络请求的寿命和时间" class="header-anchor">#</a> 网络请求的寿命和时间</h2> <p>当您收集页面导航和资源下载的时间时，您扮演的是考古学家的角色，即您要在事后重建网络请求的短暂生命。有时，它有助于可视化一个概念，并且在涉及网络请求时，没有比浏览器的开发工具更好的可视化工具。</p> <p><img src="https://developers.google.cn/web/fundamentals/performance/navigation-and-resource-timing/images/figure-2-1x.png" alt="Chrome的开发者工具可视化的网络请求时间列表。"><strong>图 2</strong>。在 Chrome 开发人员工具的网络面板中如何可视化网络请求。</p> <p>如您所见，此请求具有您期望的所有有趣的东西：DNS 查找，连接，TLS 协商等等。让我们一起来看一下导航和资源定时中的重要（不是那么重要）位，并演示哪些属性和指标可以帮助您衡量对应用程序性能至关重要的活动！让我们开始吧！</p> <p>**注意：**本指南对哪些指标最重要有些看法。如果您想同时看到这两个 API 的鸟瞰图，并在其中显示确切的订单指标，那么<a href="https://www.w3.org/TR/navigation-timing-2/#processing-model" target="_blank" rel="noopener noreferrer">此 Timing 处理模型图<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>将非常有用。</p> <h3 id="dns-查询"><a href="#dns-查询" class="header-anchor">#</a> DNS 查询</h3> <p>当用户请求 URL 时，将查询域名系统（DNS）以将域转换为 IP 地址。根据许多因素（尤其是 DNS 缓存），此过程可能会花费大量时间。也许不是，但是无论如何，这都是您想要测量的东西。导航和资源计时都公开了两个与 DNS 相关的指标：</p> <ul><li><code>domainLookupStart</code> DNS 查找开始时标记。</li> <li><code>domainLookupEnd</code> DNS 查找结束时标记。</li></ul> <p>真的很简单！当网络请求阶段是线性的时，测量其持续时间就像从终止度量中减去起始度量一样容易：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Measuring DNS lookup time</span>
<span class="token keyword">var</span> pageNav <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> dnsTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>domainLookupEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>domainLookupStart
</code></pre></div><p>现在有一些坏消息：您不能<em>总是</em>依靠某些指标来填充。这两个 API 中的某些属性将<code>0</code>在特定条件下使用。例如，如果主机未设置适当的 响应头，则<code>domainLookupStart</code>和<code>domainLookupEnd</code>（及其他）都可以<code>0</code>用于第三方提供的资源 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin" target="_blank" rel="noopener noreferrer"><code>Timing-Allow-Origin</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。我们暂时还不会涉足杂草，但是<a href="https://developers.google.cn/web/fundamentals/performance/navigation-and-resource-timing#cross-origins_and_the_timing-allow-origin_header" target="_blank" rel="noopener noreferrer">稍后我们会讨论<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。现在，让我们继续前进。</p> <h3 id="连接协商"><a href="#连接协商" class="header-anchor">#</a> 连接协商</h3> <p>与服务器建立连接后，由于客户端和服务器在将资源发送到客户端之前先进行整理，因此会发生延迟。如果使用 HTTPS（<a href="https://httparchive.org/reports/state-of-the-web#pctHttps" target="_blank" rel="noopener noreferrer">这越来越普遍<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>），则此过程还包括 TLS 协商时间。连接阶段包含三个指标：</p> <ul><li><code>connectStart</code> 客户端打开与服务器的连接时标记。</li> <li><code>secureConnectionStart</code> 当客户端开始 TLS 协商时标记。</li> <li><code>connectEnd</code> 在连接协商结束时标记（包括 TLS 时间）。</li></ul> <p>这些<em>几乎</em>和 DNS 指标一样简单，但是却<code>secureConnectionStart</code>改变了一切。您可能会问：“为什么没有<code>secureConnectionEnd</code>财产？” 答案是 TLS 协商与协商同时结束<code>connectEnd</code>。如果未使用 HTTPS（或<a href="https://en.wikipedia.org/wiki/HTTP_persistent_connection" target="_blank" rel="noopener noreferrer">HTTP 连接仍然存在<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>），则此值为<code>0</code>，因此您需要执行适当的检查，而不是假定始终填充该值：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Quantifying total connection time</span>
<span class="token keyword">var</span> pageNav <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> connectionTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>connectEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>connectStart
<span class="token keyword">var</span> tlsTime <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// &lt;-- Assume 0 by default</span>

<span class="token comment">// Did any TLS stuff happen?</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>pageNav<span class="token punctuation">.</span>secureConnectionStart <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Awesome! Calculate it!</span>
  tlsTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>connectEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>secureConnectionStart
<span class="token punctuation">}</span>
</code></pre></div><p>查找域的 IP 并建立连接后，<em>真正的</em>乐趣就开始了。</p> <h3 id="要求和回应"><a href="#要求和回应" class="header-anchor">#</a> 要求和回应</h3> <p>当我们考虑影响页面速度的因素时，我们正在考虑两个因素：</p> <ul><li>**外在因素：**这是诸如连接延迟和带宽之类的东西。作为开发人员，他们（大部分）是我们无法控制的。</li> <li>**内在因素：**这些是我们可以更好地控制的事情，例如服务器和客户端架构以及资源大小。</li></ul> <p>两种类型的因素都会影响请求和响应速度。与该过程相关的指标可以说是最重要的指标，因为它们讲述了每种资源花费多长时间的故事。导航和资源定时都使用以下度量来描述请求和响应：</p> <ul><li><code>fetchStart</code>在浏览器开始获取资源时标记。这与请求不同，因为它不标记浏览器何时对资源发出网络请求，而是标记它何时开始检查缓存（例如 HTTP 和服务工作者缓存）以查看是否甚至需要网络请求。</li> <li><code>workerStart</code>在<a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent" target="_blank" rel="noopener noreferrer">事件处理程序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（如果适用）中从<a href="https://developers.google.cn/web/fundamentals/primers/service-workers" target="_blank" rel="noopener noreferrer">服务工作者<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>获取请求时进行标记。如果当前页面未安装服务人员，则总是这样。<a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent" target="_blank" rel="noopener noreferrer"><code>fetch</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><code>0</code></li> <li><code>requestStart</code> 当浏览器发出网络请求时。</li> <li><code>responseStart</code> 是响应的第一个字节到达时。</li> <li><code>responseEnd</code> 是响应的最后一个字节到达的时间。</li></ul> <p>您可以使用这些指标来衡量加载性能的许多方面。例如，您可以在考虑缓存查找时间的同时测量资源下载时间：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Cache seek plus response time</span>
<span class="token keyword">var</span> pageNav <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> fetchTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>fetchStart

<span class="token comment">// Service worker time plus response time</span>
<span class="token keyword">var</span> workerTime <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>pageNav<span class="token punctuation">.</span>workerStart <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  workerTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>workerStart
<span class="token punctuation">}</span>
</code></pre></div><p>您还可以测量其他有用的东西，如下面的代码所示：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Request time only (excluding unload, redirects, DNS, and connection time)</span>
<span class="token keyword">var</span> requestTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>requestStart

<span class="token comment">// Response time only (download)</span>
<span class="token keyword">var</span> responseTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>responseStart

<span class="token comment">// Request + response time</span>
<span class="token keyword">var</span> requestResponseTime <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>requestStart
</code></pre></div><h3 id="其他的东西"><a href="#其他的东西" class="header-anchor">#</a> 其他的东西</h3> <p>现在，我们已经介绍了导航和资源定时提供的最重要的指标，让我们简要地看一下其中一些不太重要的指标。</p> <h4 id="文件卸载"><a href="#文件卸载" class="header-anchor">#</a> 文件卸载</h4> <p>卸载是指浏览器在加载新页面之前进行一些整理工作。这不是典型的情况下，一个大问题，但它<em>可能</em>是值得定量，如果你有一些代码（特别是第三方）在运行的 <a href="https://developer.mozilla.org/en-US/docs/Web/Events/unload" target="_blank" rel="noopener noreferrer"><code>unload</code>事件处理程序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，从渲染扬起了下一个页面。如果这描述了您的情况，则需要注意 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/unloadEventStart" target="_blank" rel="noopener noreferrer"><code>unloadEventStart</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/unloadEventEnd" target="_blank" rel="noopener noreferrer"><code>unloadEventEnd</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 指标。</p> <p>**注意：**卸载指标是“导航定时”所独有的。</p> <h4 id="重新导向"><a href="#重新导向" class="header-anchor">#</a> 重新导向</h4> <p>好的，页面重定向并不是<em>完全</em>无关紧要的，但是它们可能不是您经常遇到的问题。重定向仍然会增加请求的延迟，因此对它们进行测量可能是值得的。</p> <p><img src="https://developers.google.cn/web/fundamentals/performance/navigation-and-resource-timing/images/figure-3-1x.png" alt="在Chrome开发人员工具中可视化的重定向链。"><strong>图 3</strong>。Chrome 开发人员工具中显示的重定向链。</p> <p>如果您担心重定向，则两个 API 都提供 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/redirectStart" target="_blank" rel="noopener noreferrer"><code>redirectStart</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/redirectEnd" target="_blank" rel="noopener noreferrer"><code>redirectEnd</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 指标，这使得衡量重定向时间成为一项琐碎的任务。</p> <h4 id="文件处理"><a href="#文件处理" class="header-anchor">#</a> 文件处理</h4> <p>加载 HTML 文档时，浏览器会花一些时间来处理它们。导航计时自曝指标来衡量这一点，但除非它们通常不是间接<em>也许</em>你在提供巨大的文件。如果你有兴趣在文档处理指标，它们是 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/domInteractive" target="_blank" rel="noopener noreferrer"><code>domInteractive</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>， <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/domContentLoadedEventStart" target="_blank" rel="noopener noreferrer"><code>domContentLoadedEventStart</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>， <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/domContentLoadedEventEnd" target="_blank" rel="noopener noreferrer"><code>domContentLoadedEventEnd</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，和 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/domComplete" target="_blank" rel="noopener noreferrer"><code>domComplete</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>**注意：**文档处理指标是“导航定时”所独有的。</p> <h4 id="载入中"><a href="#载入中" class="header-anchor">#</a> 载入中</h4> <p>文档及其资源完全完成加载后，浏览器将触发一个<a href="https://developer.mozilla.org/en-US/docs/Web/Events/load" target="_blank" rel="noopener noreferrer"><code>load</code> 事件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。一些人强调加载时间是度量的最高标准，但是 已经发生了重点<a href="https://www.stevesouders.com/blog/2013/05/13/moving-beyond-window-onload/" target="_blank" rel="noopener noreferrer">转移，<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>以将感知度量（例如<a href="https://sites.google.com/a/webpagetest.org/docs/using-webpagetest/metrics/speed-index" target="_blank" rel="noopener noreferrer">Speed Index<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）优先于加载时间。</p> <p>不过，测量加载时间可能对您有所帮助。 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/loadEventStart" target="_blank" rel="noopener noreferrer"><code>loadEventStart</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 并 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/loadEventEnd" target="_blank" rel="noopener noreferrer"><code>loadEventEnd</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 可以在文档方面为您提供帮助，但是使用该<code>duration</code>属性可能最简单。</p> <p>**注意：**和指标是导航计时所独有的。 <code>loadEventStart``loadEventEnd</code></p> <h4 id="文件和资源大小"><a href="#文件和资源大小" class="header-anchor">#</a> 文件和资源大小</h4> <p>文档或资源的<em>大小</em>无疑对加载性能有影响。幸运的是，两个 API 都公开了用于量化资源有效载荷的属性：</p> <ul><li><code>transferSize</code>是资源的<em>总大小</em>，包括 HTTP 标头。</li> <li><code>encodedBodySize</code>是资源的<em>压缩大小</em>，<em>不包括</em> HTTP 标头。</li> <li><code>decodedBodySize</code>是资源的<em>解压缩大小</em>（再次，不包括 HTTP 标头）。</li></ul> <p>使用简单的算法，很容易找出响应的多少由 HTTP 标头或什至压缩率组成：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// HTTP header size</span>
<span class="token keyword">var</span> pageNav <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> headerSize <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>transferSize <span class="token operator">-</span> pageNav<span class="token punctuation">.</span>encodedBodySize

<span class="token comment">// Compression ratio</span>
<span class="token keyword">var</span> compressionRatio <span class="token operator">=</span> pageNav<span class="token punctuation">.</span>decodedBodySize <span class="token operator">/</span> pageNav<span class="token punctuation">.</span>encodedBodySize
</code></pre></div><p>您可能已经意识到资源的大小，并且您实际上并不需要 API 来告诉您这些信息，因为任何浏览器的开发工具中的网络面板都可以传达这些信息。但是，如果需要，信息<em>就</em>在那里。</p> <h2 id="在应用程序代码中获取时间"><a href="#在应用程序代码中获取时间" class="header-anchor">#</a> 在应用程序代码中获取时间</h2> <p>现在您已经知道了这些 API 提供的一些指标，下面让我们介绍如何在应用程序代码中收集这些数据。</p> <h3 id="其他手动获取时间的方法"><a href="#其他手动获取时间的方法" class="header-anchor">#</a> 其他手动获取时间的方法</h3> <p>在本指南的前面，您已经涉足了<code>getEntriesByType</code>，这对于获取特定类型的性能条目非常有用。但是，还有两个其他相关方法值得一提。</p> <h4 id="getentriesbyname"><a href="#getentriesbyname" class="header-anchor">#</a> <code>getEntriesByName</code></h4> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName" target="_blank" rel="noopener noreferrer"><code>getEntriesByName</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 通过其名称获得一个表演条目。对于导航和资源计时，这是文档或资源的 URL：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Get timing data for an important hero image</span>
<span class="token keyword">var</span> heroImageTime <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByName</span><span class="token punctuation">(</span><span class="token string">'https://somesite.com/images/hero-image.jpg'</span><span class="token punctuation">)</span>
</code></pre></div><p>如果您需要获取单个资源的性能条目，这将<em>非常</em>有用。与通过其他方式过滤掉数组相比，这也是一种性能更好的替代方法。</p> <h4 id="getentries"><a href="#getentries" class="header-anchor">#</a> getEntries</h4> <p>与<code>getEntriesByName</code>和不同<code>getEntriesByType</code>，<a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries" target="_blank" rel="noopener noreferrer"><code>getEntries</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 默认情况下， 所有内容都在性能条目缓冲区中获取：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Get timing data for all entries in the performance entry buffer</span>
<span class="token keyword">var</span> allTheTimings <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>如果<code>initiatorType</code>您觉得新手，那是因为我在这里没有介绍。 <a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/initiatorType" target="_blank" rel="noopener noreferrer">在 MDN <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/initiatorType" target="_blank" rel="noopener noreferrer">了解更多信息<code>initiatorType</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="使用-performanceobserver-收听性能条目"><a href="#使用-performanceobserver-收听性能条目" class="header-anchor">#</a> 使用 PerformanceObserver 收听性能条目</h3> <p>因为像<code>getEntriesByType</code>返回数组这样的方法，您可能很想使用循环来处理它们并说“足够好”，但是由于以下原因，这种方法存在问题：</p> <ul><li>循环（尤其是在具有许多条目的数组上）占用了主线程。</li> <li>循环仅捕获运行循环时可用的性能条目。通过计时器定期轮询性能条目缓冲区非常昂贵，并且会与渲染器竞争，这可能会导致垃圾邮件。</li></ul> <p><a href="https://developers.google.cn/web/updates/2016/06/performance-observer" target="_blank" rel="noopener noreferrer"><code>PerformanceObserver</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>旨在解决此类烦恼。使用类似于<a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver" target="_blank" rel="noopener noreferrer">Mutation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>或 <a href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver" target="_blank" rel="noopener noreferrer">Intersection Observer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的观察者模式 ，您可以分配一个回调，该回调在记录新的性能条目时运行：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Instantiate the performance observer</span>
<span class="token keyword">var</span> perfObserver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">list<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Get all the resource entries collected so far</span>
  <span class="token comment">// (You can also use getEntriesByType/getEntriesByName here)</span>
  <span class="token keyword">var</span> entries <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// Iterate over entries</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> entries<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do the work!</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Run the observer</span>
perfObserver<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// Polls for Navigation and Resource Timing entries</span>
  entryTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'navigation'</span><span class="token punctuation">,</span> <span class="token string">'resource'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>如果您没有与观察员的经验，这种模式最初可能会感到尴尬，但很快就会成为第二天性。明智的选择： <code>PerformanceObserver</code>并非在所有浏览器中都可用，导航和资源定时都可用！实际上，Internet Explorer 和 Edge 都不支持 <code>PerformanceObserver</code>，因此请进行功能检查以避免怪异：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Should we even be doing anything with perf APIs?</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'performance'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// OK, yes. Check PerformanceObserver support</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'PerformanceObserver'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Observe ALL the performance entries!</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// WOMP WOMP. Find another way. Or not.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用这样的代码，您可以自己决定如何收集性能计时（如果有的话）。您可能会决定，如果<code>PerformanceObserver</code>没有收集时间，则不值得为此烦恼。这完全取决于您！</p> <h3 id="陷阱"><a href="#陷阱" class="header-anchor">#</a> 陷阱</h3> <p>使用计时并非总是那么简单。您可能还记得过，我们提出了如何在某些情况下以您期望的方式填充某些时间安排，以及可能存在其他棘手的情况。</p> <h4 id="跨域和-timing-allow-origin-标头"><a href="#跨域和-timing-allow-origin-标头" class="header-anchor">#</a> 跨域和 Timing-Allow-Origin 标头</h4> <p>收集跨域资源的指标很奇怪，因为如果 未设置<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin" target="_blank" rel="noopener noreferrer"><code>Timing-Allow-Origin</code> 标头，<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>则并非所有性能计时都可以访问。要了解哪些指标受此影响，请查看“资源时序”规范的<a href="https://www.w3.org/TR/resource-timing-2/#cross-origin-resources" target="_blank" rel="noopener noreferrer">这一部分<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>如果您在多个域上运行应用程序，或者将公共资产作为第三方提供，则应设置适当的<code>Timing-Allow-Origin</code>标头，以便开发人员可以捕获托管在它们上的资源的时间安排。查看<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin" target="_blank" rel="noopener noreferrer">MDN 文档 <code>Timing-Allow-Origin</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 以了解更多信息。</p> <h4 id="持续的连接会影响时序"><a href="#持续的连接会影响时序" class="header-anchor">#</a> 持续的连接会影响时序</h4> <p>持久 HTTP 连接是指重新使用连接以传输其他资源时。使用<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Keep-Alive" target="_blank" rel="noopener noreferrer"><code>Connection: Keep-Alive</code> 标头<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>时，这会在 HTTP / 1 中发生。通过 HTTP / 2 提供内容时，将使用单个连接流式传输 该源的<em>所有</em>资源。此行为会影响时间。您不必显式地检查它，而稍后使用度量时则需要注意。</p> <h4 id="这些-api-并非随处可用"><a href="#这些-api-并非随处可用" class="header-anchor">#</a> 这些 API 并非随处可用</h4> <p>如果在网络上工作可以教给您任何知识，那就是您不能依赖于随处可用的 API。导航和资源定时也是如此。像这样的方法最大的优点<code>getEntriesByType</code>是，如果有可用的方法，则找不到任何东西也不会抛出错误。</p> <p>一切都很好，但这可能会引起一些混乱。在 Safari 的奇怪情况下（从 11.2 版开始），支持资源定时，但不支持导航定时。这导致如下情况：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// This returns stuff!</span>
performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'resource'</span><span class="token punctuation">)</span>

<span class="token comment">// Not so much. :\</span>
performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span>
</code></pre></div><p>虽然这很痛苦，但这不是世界末日。使用这些方法获取条目时，只需检查是否返回了任何内容：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Yay, we have Navigation Timing stuff!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>无论浏览器是否支持这些 API，这都是一项明智的选择。您永远不要对可用数据进行假设，因为在某些情况下，假设可能适得其反。</p> <h2 id="给家里打电话"><a href="#给家里打电话" class="header-anchor">#</a> 给家里打电话</h2> <p>因此，我们现在知道如何使用这些 API 并从它们中获取数据，但是如何将这些数据获取到可以使用它们的地方？尽管这绝不是 RUM 数据收集的详尽参考，但它是一个起点。</p> <h3 id="使用-navigator-sendbeacon"><a href="#使用-navigator-sendbeacon" class="header-anchor">#</a> 使用 <code>navigator.sendBeacon</code></h3> <p>您已经收集了性能条目，现在可以将它们发送到某个地方以供以后分析了。但是最好的方法是什么？</p> <p>诸如<a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon" target="_blank" rel="noopener noreferrer"><code>navigator.sendBeacon</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> （或更近期的<a href="https://www.chromestatus.com/feature/5760375567941632" target="_blank" rel="noopener noreferrer">获取<code>keepalive</code> 标志<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）之类的 API 可以以非阻塞方式发送请求，这对于 RUM 分析或不需要等待响应的其他类型的请求非常理想。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Caution: If you have a _lot_ of performance entries, don't send _everything_ via getEntries. This is just an example.</span>
<span class="token keyword">let</span> rumData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>performance<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Check for sendBeacon support:</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'sendBeacon'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Beacon the requested</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span><span class="token function">sendBeacon</span><span class="token punctuation">(</span><span class="token string">'/analytics'</span><span class="token punctuation">,</span> rumData<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// sendBeacon worked! We're good!</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// sendBeacon failed! Use XHR or fetch instead</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// sendBeacon not available! Use XHR or fetch instead</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在另一端将是一些后端代码，这些代码查看 POST 表单数据并从那里决定如何处理它。如何执行此操作取决于您的应用程序后端。</p> <p>**注意：**仅在调用时将请求<em>排队</em>，而不能立即完成。另外，用户代理对可以发送多少数据施加了限制，并且如果超出该限制，则可以拒绝该请求。 <code>navigator.sendBeacon</code></p> <h2 id="包起来"><a href="#包起来" class="header-anchor">#</a> 包起来</h2> <p>总结一下，这里有一些自以为是的观点：如果您不确定这些计时的工作方式，请不要在前端计算指标，而将计算的数据发送到后端。存储原始指标，以后再使用。出于多种原因，这是有优势的，但主要是因为它很灵活。如果存储原始指标，则以后总是可以在出现测量错误时进行更正。</p> <p>最后，您不需要存储这些 API 提供的<em>每个</em>指标。例如，如果你知道一个事实，你不需要来衡量 DOM 处理时间，不觉得你<em>有</em>来存储这些指标。</p> <p>当然，本指南并不是要成为这些 API 的详尽资源，而是要帮助您放心使用它们。如果您想要有关此主题的其他观点，请阅读以下其他内容：</p> <ul><li><a href="https://www.w3.org/TR/navigation-timing-2/" target="_blank" rel="noopener noreferrer">导航计时 2 级规格<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.w3.org/TR/resource-timing-2/" target="_blank" rel="noopener noreferrer">资源时序 2 级规范。<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://developers.google.cn/web/tools/chrome-devtools/network-performance/understanding-resource-timing" target="_blank" rel="noopener noreferrer">了解资源计时。<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://nicj.net/resourcetiming-in-practice/" target="_blank" rel="noopener noreferrer">实践中的资源计时。<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://community.akamai.com/community/web-performance/blog/2016/08/25/using-navigation-timing-apis-to-understand-your-webpage" target="_blank" rel="noopener noreferrer">使用导航计时 API 来了解您的网页。<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>即使您通常避开深入的技术性阅读，对于导航和资源时序的官方规范也很容易理解。他们还以一种非常有益的方式打破了陷阱。如果你问自己“当问题<em>是</em> <code>secureConnectionStart</code> <code>0</code>？”，规格说明一切怪事相当不错。</p> <p>使用这些 API，您将可以更好地了解实际用户如何体验加载性能。这意味着您将有能力更好地诊断和解决野外性能问题，并且该知识真正强大。</p> <p><em>特别感谢<a href="https://developers.google.cn/web/resources/contributors/paulirish" target="_blank" rel="noopener noreferrer">Paul Irish<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，Gray Norton，<a href="https://developers.google.cn/web/resources/contributors/addyosmani" target="_blank" rel="noopener noreferrer">Addy Osmani<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://developers.google.cn/web/resources/contributors/philipwalton" target="_blank" rel="noopener noreferrer">Philip Walton<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的宝贵反馈，这些反馈显着提高了本文的质量。</em></p></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/ed916f/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">速度工具</div></a> <a href="/pages/13c2e2/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">以用户为中心的性能指标</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/ed916f/" class="prev">速度工具</a></span> <span class="next"><a href="/pages/13c2e2/">以用户为中心的性能指标</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/1c4e14/"><div>你想知道的css hack知识全都帮你整理好了</div></a> <span>06-08</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/d8a080/"><div>问题和经验</div></a> <span>06-08</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/a93118/"><div>CSS Hack</div></a> <span>06-08</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:894072666@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/xugaoyi" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2021
    <span>Evan Xu | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.40794b05.js" defer></script><script src="/assets/js/2.21c2c3d2.js" defer></script><script src="/assets/js/215.0422f8a3.js" defer></script>
  </body>
</html>